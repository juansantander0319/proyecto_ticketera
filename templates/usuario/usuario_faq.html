{% extends "base_usuario.html" %}

{% block title %}Base de Conocimiento - Ticketera{% endblock %}

{% block content %}
<div class="container-fluid fade-in">
  <main class="px-md-4 py-4">
    <h2 class="mt-4"><i class="bi bi-journal-text"></i> Base de Conocimiento</h2>
    <p class="text-muted">Encuentra guías y soluciones a problemas comunes.</p>

    <form method="GET" action="{{ url_for('usuario_faq') }}">
      <div class="input-group mb-4 shadow-sm">
        <input type="search" class="form-control" name="query" placeholder="Buscar un artículo..." value="{{ query or '' }}">
        <button class="btn btn-primary" type="submit"><i class="bi bi-search"></i> Buscar</button>
      </div>
    </form>

    <div class="accordion" id="faqAccordion">
      {% if not articulos %}
        <p class="text-center text-muted">No se encontraron artículos. Intenta con otra búsqueda.</p>
      {% else %}
        {% for articulo in articulos %}
        <div class="accordion-item">
          <h2 class="accordion-header" id="heading{{ loop.index }}">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ loop.index }}">
              {{ articulo.titulo }}
            </button>
          </h2>
          <div id="collapse{{ loop.index }}" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
            <div class="accordion-body">
              <p><strong>Categoría:</strong> <span class="badge bg-secondary">{{ articulo.categoria_faq }}</span></p>
              <hr>
              {{ articulo.contenido|safe }}
            </div>
          </div>
        </div>
        {% endfor %}
      {% endif %}
    </div>
  </main>
</div>
{% endblock %}